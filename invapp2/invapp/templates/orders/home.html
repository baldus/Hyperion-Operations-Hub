{% extends "base.html" %}
{% from "orders/_orders_table.html" import render_orders_table %}

{% block content %}
<h2>Production Orders</h2>

<div class="orders-toolbar">
    <div class="toolbar-actions">
        {% if can_edit_page('orders') %}
            <a href="{{ url_for('orders.new_order') }}" class="action-btn primary-action">Create New Order</a>
            <a href="{{ url_for('orders.prioritize_orders') }}" class="action-btn subtle-action">Prioritize</a>
        {% endif %}
        <a href="{{ url_for('orders.schedule_view') }}" class="action-btn subtle-action">Schedule</a>
        <a href="{{ url_for('work.station_overview') }}" class="action-btn subtle-action">Workstations</a>
        <a href="{{ url_for('orders.view_open_orders') }}" class="action-btn subtle-action">Open Orders</a>
        <a href="{{ url_for('orders.view_closed_orders') }}" class="action-btn subtle-action">Closed Orders</a>
    </div>
    <form method="get" class="orders-filter">
        <label for="orders-search" class="sr-only">Search orders</label>
        <input id="orders-search" type="search" name="q" placeholder="Search by order # or finished good" value="{{ search_term }}">
        <label for="orders-customer" class="sr-only">Filter by customer</label>
        <input id="orders-customer" type="search" name="customer" placeholder="Filter by customer" value="{{ customer_filter }}">
        <button type="submit">Filter</button>
        {% if search_term or customer_filter %}
        <a class="action-btn subtle-action" href="{{ url_for('orders.orders_home') }}">Clear</a>
        {% endif %}
    </form>
</div>

{% if orders %}
{{ render_orders_table(orders, today) }}
{% else %}
    <div class="empty-state">
        {% if can_edit_page('orders') %}
            <p>No open orders yet. Create a new order to get started.</p>
            <a href="{{ url_for('orders.new_order') }}" class="action-btn primary-action">Create New Order</a>
        {% else %}
            <p>No open orders yet.</p>
        {% endif %}
    </div>
{% endif %}
{% endblock %}
