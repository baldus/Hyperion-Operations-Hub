{% extends "base.html" %}
{% from "orders/_orders_table.html" import render_orders_table %}

{% block content %}
<h2>Production Orders</h2>

<div class="orders-toolbar">
    <div class="toolbar-actions">
        {% if current_user.is_authenticated and current_user.has_role('admin') %}
            <a href="{{ url_for('orders.new_order') }}" class="action-btn primary-action">Create New Order</a>
            <a href="{{ url_for('orders.bom_library') }}" class="action-btn subtle-action">BOM Library</a>
            <a href="{{ url_for('orders.view_waiting_orders') }}" class="action-btn subtle-action">Waiting on Material</a>
        {% endif %}
        <a href="{{ url_for('orders.schedule_view') }}" class="action-btn subtle-action">Schedule</a>
        <a href="{{ url_for('orders.view_open_orders') }}" class="action-btn subtle-action">Open Orders</a>
        <a href="{{ url_for('orders.view_closed_orders') }}" class="action-btn subtle-action">Closed Orders</a>
    </div>
    <form method="get" class="orders-filter">
        <label for="orders-search" class="sr-only">Search orders</label>
        <input id="orders-search" type="search" name="q" placeholder="Search by order # or finished good" value="{{ search_term }}">
        <button type="submit">Filter</button>
    </form>
</div>

{% if orders %}
{{ render_orders_table(orders) }}
{% else %}
    <div class="empty-state">
        {% if current_user.is_authenticated and current_user.has_role('admin') %}
            <p>No open orders yet. Create a new order to get started.</p>
            <a href="{{ url_for('orders.new_order') }}" class="action-btn primary-action">Create New Order</a>
        {% else %}
            <p>No open orders yet.</p>
        {% endif %}
    </div>
{% endif %}
{% endblock %}
