{% extends "base.html" %}
{% block content %}
<div class="d-flex justify-content-between align-items-center flex-wrap gap-3">
  <div>
    <h2>Count Sheets (By Aisle) — Snapshot #{{ snapshot.id }}</h2>
    <p class="field-note mb-1">
      Print this sheet for floor counts. Counted Qty and Notes are intentionally blank.
    </p>
    <p class="text-muted small mb-0">
      Snapshot: {{ snapshot.source_filename or "ERP import" }} • {{ today.strftime('%Y-%m-%d') }}
    </p>
  </div>
  <div class="no-print">
    <button class="btn btn-outline-primary" type="button" onclick="window.print()">Print this aisle</button>
  </div>
</div>

<form method="get" class="mt-3 no-print">
  <label for="aisle-select" class="form-label">Select Aisle</label>
  <div class="d-flex gap-2 align-items-end">
    <select id="aisle-select" name="aisle" class="form-select" onchange="this.form.submit()">
      {% for aisle in aisles %}
      <option value="{{ aisle }}" {% if aisle == selected_aisle %}selected{% endif %}>{{ aisle }}</option>
      {% endfor %}
    </select>
    <noscript>
      <button type="submit" class="btn btn-outline-secondary">Go</button>
    </noscript>
  </div>
</form>

<div class="mt-4">
  <h4 class="mb-2">Aisle {{ selected_aisle or '—' }}</h4>
  <div class="table-responsive">
    <table class="table table-sm">
      <thead>
        <tr>
          <th>Aisle</th>
          <th>Location Code</th>
          <th>Location Description</th>
          <th>Item Name</th>
          <th>Item Description</th>
          <th>SKU</th>
          <th>ERP Total Qty</th>
          <th>Counted Qty</th>
          <th>Notes</th>
        </tr>
      </thead>
      <tbody>
        {% if rows %}
          {% for row in rows %}
          <tr>
            <td>{{ row.aisle }}</td>
            <td>{{ row.location_code }}</td>
            <td>{{ row.location_description }}</td>
            <td>{{ row.item_name }}</td>
            <td>{{ row.item_description }}</td>
            <td>{{ row.sku }}</td>
            <td>{{ row.erp_quantity }}</td>
            <td></td>
            <td></td>
          </tr>
          {% endfor %}
        {% else %}
          <tr>
            <td colspan="9" class="text-muted">No rows found for this aisle.</td>
          </tr>
        {% endif %}
      </tbody>
    </table>
  </div>
</div>

<a href="{{ url_for('inventory.physical_inventory_snapshot', snapshot_id=snapshot.id) }}" class="btn btn-secondary no-print">Back to Snapshot</a>
{% endblock %}

{% block extra_styles %}
<style>
  @media print {
    .no-print {
      display: none !important;
    }
    h2 {
      margin-top: 0;
    }
  }
</style>
{% endblock %}
